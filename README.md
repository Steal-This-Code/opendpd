
<!-- README.md is generated from README.Rmd. Please edit that file -->

# opendpd

<!-- badges: start -->
<!-- badges: end -->

The goal of opendpd is to provide an easy-to-use R interface for
accessing various Dallas Police public safety datasets via the Socrata
Open Data API, including functions for data retrieval and basic
cleaning.

## Installation

You can install the development version of opendpd like so:

``` r
# install.packages("remotes") # Uncomment if user might not have remotes
remotes::install_github("Steal-This-Code/opendpd")
```

## Example

This is a basic example which shows you how to solve a common problem:

``` r
library(opendpd)

# Get the 10 most recent police incidents
recent_incidents_raw <- get_incidents(limit = 10, `$order` = "date1 DESC")
#> Starting data retrieval...
#> Reached limit of 10
#> Total records retrieved: 10
#> Data retrieval complete.

# Apply basic cleaning (lowercase text, parse dates)
# Needs stringr and lubridate installed
recent_incidents_clean <- clean_incidents_data(recent_incidents_raw)
#> Warning: Specified `text_fields` not found and skipped: type
#> Applying text cleaning (lower, trim, squish) to columns: division, district, sector, beat, premise, offincident, signal, ucr_disp, status
#> Attempting to convert date columns to POSIXct (tz= America/Chicago ): date1, date2_of_occurrence_2, reporteddate, edate, callorgdate, callreceived, callcleared, calldispatched, upzdate

# Show the first few rows and structure
print(head(recent_incidents_clean))
#> # A tibble: 6 × 80
#>   incidentnum servyr servnumid      watch signal   offincident premise objattack
#>   <chr>       <chr>  <chr>          <chr> <chr>    <chr>       <chr>   <chr>    
#> 1 048781-2025 2025   048781-2025-01 2     43 - ro… deadly con… highwa… N/A      
#> 2 049092-2025 2025   049092-2025-01 3     32 - su… criminal t… storag… N/A      
#> 3 049030-2025 2025   049030-2025-01 3     58 - ro… man del co… apartm… N/A      
#> 4 048694-2025 2025   048694-2025-01 1     11v/01 … bmv         outdoo… Motor Ve…
#> 5 048990-2025 2025   048990-2025-01 3     41/20 -… robbery of… single… N/A      
#> 6 048740-2025 2025   048740-2025-01 1     7x - ma… traf vio -… highwa… N/A      
#> # ℹ 72 more variables: incident_address <chr>, ra <chr>, beat <chr>,
#> #   division <chr>, sector <chr>, date1 <dttm>, year1 <chr>, month1 <chr>,
#> #   day1 <chr>, time1 <chr>, date1dayofyear <chr>,
#> #   date2_of_occurrence_2 <dttm>, year2 <chr>, month2 <chr>, day2 <chr>,
#> #   time2 <chr>, date2dayofyear <chr>, reporteddate <dttm>, edate <dttm>,
#> #   eyear <chr>, emonth <chr>, eday <chr>, etime <chr>, edatedayofyear <chr>,
#> #   cfs_number <chr>, callorgdate <dttm>, callreceived <dttm>, …
str(recent_incidents_clean)
#> tibble [10 × 80] (S3: tbl_df/tbl/data.frame)
#>  $ incidentnum                  : chr [1:10] "048781-2025" "049092-2025" "049030-2025" "048694-2025" ...
#>  $ servyr                       : chr [1:10] "2025" "2025" "2025" "2025" ...
#>  $ servnumid                    : chr [1:10] "048781-2025-01" "049092-2025-01" "049030-2025-01" "048694-2025-01" ...
#>  $ watch                        : chr [1:10] "2" "3" "3" "1" ...
#>  $ signal                       : chr [1:10] "43 - road rage" "32 - suspicious person" "58 - routine investigation" "11v/01 - burg motor veh" ...
#>  $ offincident                  : chr [1:10] "deadly conduct" "criminal trespass warning" "man del cont sub pen grp 1 > or equal 1g<4g" "bmv" ...
#>  $ premise                      : chr [1:10] "highway, street, alley etc" "storage facility" "apartment residence" "outdoor area public/private" ...
#>  $ objattack                    : chr [1:10] "N/A" "N/A" "N/A" "Motor Vehicle" ...
#>  $ incident_address             : chr [1:10] "1400 REGAL ROW" "5409 S WESTMORELAND RD" "1400 BOTHAM JEAN BLVD" "1219 ENGLE AVE" ...
#>  $ ra                           : chr [1:10] "1177" "4027" "4342" "4211" ...
#>  $ beat                         : chr [1:10] "512" "437" "151" "443" ...
#>  $ division                     : chr [1:10] "northwest" "southwest" "central" "southwest" ...
#>  $ sector                       : chr [1:10] "510" "430" "150" "440" ...
#>  $ date1                        : POSIXct[1:10], format: "2025-04-08" "2025-04-08" ...
#>  $ year1                        : chr [1:10] "2025" "2025" "2025" "2025" ...
#>  $ month1                       : chr [1:10] "April" "April" "April" "April" ...
#>  $ day1                         : chr [1:10] "Tue" "Tue" "Tue" "Tue" ...
#>  $ time1                        : chr [1:10] "09:00" "22:00" "18:30" "02:30" ...
#>  $ date1dayofyear               : chr [1:10] "98" "98" "98" "98" ...
#>  $ date2_of_occurrence_2        : POSIXct[1:10], format: "2025-04-08" "2025-04-08" ...
#>  $ year2                        : chr [1:10] "2025" "2025" "2025" "2025" ...
#>  $ month2                       : chr [1:10] "April" "April" "April" "April" ...
#>  $ day2                         : chr [1:10] "Tue" "Tue" "Tue" "Tue" ...
#>  $ time2                        : chr [1:10] "09:01" "22:35" "18:30" "02:30" ...
#>  $ date2dayofyear               : chr [1:10] "98" "98" "98" "98" ...
#>  $ reporteddate                 : POSIXct[1:10], format: "2025-04-08 09:08:00" "2025-04-08 22:36:00" ...
#>  $ edate                        : POSIXct[1:10], format: "2025-04-08 10:30:14" "2025-04-08 23:48:59" ...
#>  $ eyear                        : chr [1:10] "2025" "2025" "2025" "2025" ...
#>  $ emonth                       : chr [1:10] "April" "April" "April" "April" ...
#>  $ eday                         : chr [1:10] "Tue" "Tue" "Tue" "Tue" ...
#>  $ etime                        : chr [1:10] "10:30" "23:48" "21:07" "03:25" ...
#>  $ edatedayofyear               : chr [1:10] "98" "98" "98" "98" ...
#>  $ cfs_number                   : chr [1:10] "25-0602399" "25-0606757" "25-0606346" "25-0601321" ...
#>  $ callorgdate                  : POSIXct[1:10], format: "2025-04-08 09:08:26" "2025-04-08 22:36:34" ...
#>  $ callreceived                 : POSIXct[1:10], format: "2025-04-08 09:08:26" "2025-04-08 22:36:34" ...
#>  $ callcleared                  : POSIXct[1:10], format: "2025-04-08 12:03:46" "2025-04-09 00:48:11" ...
#>  $ calldispatched               : POSIXct[1:10], format: "2025-04-08 09:48:18" "2025-04-08 23:24:15" ...
#>  $ involvement                  : chr [1:10] "Victim" "Victim" "Victim" "Victim" ...
#>  $ victimtype                   : chr [1:10] "Individual" "Business" "Society/Public" "Individual" ...
#>  $ comprace                     : chr [1:10] "Black" NA NA "White" ...
#>  $ compethnicity                : chr [1:10] "Non-Hispanic or Latino" NA NA "Non-Hispanic or Latino" ...
#>  $ compsex                      : chr [1:10] "Male" NA NA "Male" ...
#>  $ ro1badge                     : chr [1:10] "10877" "11757" "11441" "8311" ...
#>  $ ro1name                      : chr [1:10] "TURPIN,MARK" "LOPEZ,ESAI" "SOTO,JESUS" "HUNTLEY,QUINN,MICHAEL" ...
#>  $ reptoff                      : chr [1:10] "10877" "11757" "11441" "8311" ...
#>  $ assoffbadge                  : chr [1:10] "9976" NA NA "7852" ...
#>  $ reviewbadgenum               : chr [1:10] "130917" "135021" "111210" "8349" ...
#>  $ elenum                       : chr [1:10] "B546" "E422" "U254" "E413" ...
#>  $ followup1                    : chr [1:10] "Investigations" NA NA "Investigations" ...
#>  $ followup2                    : chr [1:10] "Capers / Assaults" NA NA "Property Crime Division / SW Property Crimes" ...
#>  $ status                       : chr [1:10] "open" NA "open" "suspended" ...
#>  $ ucr_disp                     : chr [1:10] "open" NA "open" "suspended" ...
#>  $ mo                           : chr [1:10] "SUSPECT PULLED GUN ON COMP." "SUSPECT WAS ON PROPERTY WITHOUT PREMISSION" "UNKNOWN SUSPECT SOLD COCAINE." "UNKNOWN SUSPECT BURGLARIZED THE COMP VEHICLE. NO PROPERTY TAKEN" ...
#>  $ family                       : logi [1:10] FALSE FALSE FALSE FALSE FALSE FALSE ...
#>  $ hatecrimedescriptn           : chr [1:10] "None" "None" "None" "None" ...
#>  $ weaponused                   : chr [1:10] "Handgun" NA NA NA ...
#>  $ gang                         : chr [1:10] "UNK" NA NA NA ...
#>  $ drug                         : chr [1:10] "No" "No" "Yes" "No" ...
#>  $ offensecode                  : chr [1:10] "MA-53990001-H66" "NA-99999999-MSC11" "F2-35990002-O22" "MA-22990011-F287" ...
#>  $ cjis                         : chr [1:10] "53990001" "99999999" "35990002" "22990011" ...
#>  $ penalcode                    : chr [1:10] "PC 22.05(a)" "No Offense" "HSC 481.112(c)" "PC 30.04(d)" ...
#>  $ nibrs_crime                  : chr [1:10] "AGG ASSAULT - NFV" "MISCELLANEOUS" "DRUG/ NARCOTIC VIOLATIONS" "THEFT FROM MOTOR VEHICLE" ...
#>  $ nibrs_crime_category         : chr [1:10] "ASSAULT OFFENSES" "MISCELLANEOUS" "DRUG/ NARCOTIC VIOLATIONS" "LARCENY/ THEFT OFFENSES" ...
#>  $ nibrs_crimeagainst           : chr [1:10] "PERSON" "MISCELLANEOUS" "SOCIETY" "PROPERTY" ...
#>  $ nibrs_code                   : chr [1:10] "13A" "999" "35A" "23F" ...
#>  $ nibrs_group                  : chr [1:10] "A" "C" "A" "A" ...
#>  $ nibrs_type                   : chr [1:10] "Coded" "999 - No Coded" "Coded" "Coded" ...
#>  $ upzdate                      : POSIXct[1:10], format: "2025-04-08 13:57:49" "2025-04-09 00:51:57" ...
#>  $ x_coordinate                 : chr [1:10] "2466246.77358412" "2465963.07702524" "2492371.73181544" "2478192.16045488" ...
#>  $ y_cordinate                  : chr [1:10] "6989635.53773062" "6934557.97233437" "6966573.44645363" "6948816.00164923" ...
#>  $ zip_code                     : chr [1:10] "75247" "75237" "75215" "75224" ...
#>  $ city                         : chr [1:10] "DALLAS" "DALLAS" "DALLAS" "DALLAS" ...
#>  $ state                        : chr [1:10] "TX" "TX" "TX" "TX" ...
#>  $ district                     : chr [1:10] NA NA NA "d4" ...
#>  $ ro2badge                     : chr [1:10] NA NA NA NA ...
#>  $ ro2name                      : chr [1:10] NA NA NA NA ...
#>  $ taag                         : chr [1:10] NA NA NA NA ...
#>  $ geocoded_column.latitude     : chr [1:10] "32.83268" "32.68046" "32.76737" "32.7195" ...
#>  $ geocoded_column.longitude    : chr [1:10] "-96.87944" "-96.88375" "-96.79509" "-96.84258" ...
#>  $ geocoded_column.human_address: chr [1:10] "{\"address\": \"1400 REGAL ROW\", \"city\": \"DALLAS\", \"state\": \"TX\", \"zip\": \"75247\"}" "{\"address\": \"5409 S WESTMORELAND RD\", \"city\": \"DALLAS\", \"state\": \"TX\", \"zip\": \"75237\"}" "{\"address\": \"1400 BOTHAM JEAN BLVD\", \"city\": \"DALLAS\", \"state\": \"TX\", \"zip\": \"75215\"}" "{\"address\": \"1219 ENGLE AVE\", \"city\": \"DALLAS\", \"state\": \"TX\", \"zip\": \"75224\"}" ...
```
